<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <style>
      body {
        margin: 0;
        padding: 5px;
        font-family: Georgia, "Times New Roman", Times, serif;
        font-size: 12px; /* Reducimos el tamaño base para ahorrar espacio */
      }

      .table-container {
        margin-top: 5px;
        margin-left: 5px;
        margin-right: 5px;
        overflow: auto;
        page-break-inside: avoid; /* Evita que las tablas se dividan entre páginas */
      }

      table {
        width: 100%;
        border-collapse: collapse;
        page-break-inside: avoid;
      }

      th,
      td {
        border: 0.5px solid rgb(7, 7, 7);
        text-align: left;
        padding: 4px; /* Reducimos el padding para ahorrar espacio */
        background-color: rgb(255, 255, 255);
        color: rgb(0, 0, 0);
        vertical-align: top; /* Alinea el contenido en la parte superior */
      }

      .advertencia,
      .descriodocutme {
        text-align: justify;
        text-align: center;
        font-size: 8px; /* Tamaño más pequeño para notas */
        background-color: #ffffff;
      }

      .texcenter {
        text-align: center;
        background-color: rgb(255, 255, 255);
        color: rgb(8, 8, 8);
      }

      p {
        color: rgb(0, 0, 0);
        overflow-wrap: break-word;
        word-break: break-all;
        font-weight: normal;
        margin: 0; /* Eliminamos márgenes innecesarios */
      }

      .page-margins {
        max-width: 800px;
        margin: 24px auto;
        background: #fff;
        box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.04);
        padding: 24px 18px;
        border-radius: 8px;
      }

      /* Reglas específicas para impresión */
      @media print {
        body {
          margin: 0;
          padding: 0;
        }
        .page-margins {
          box-shadow: none;
          border-radius: 0;
          background: #fff;
          margin: 0 auto !important;
          padding: 0 !important;
          max-width: 100%;
        }
        .table-container {
          page-break-inside: avoid;
        }
        table {
          page-break-inside: avoid;
        }
        th,
        td {
          page-break-inside: avoid;
        }
        /* Aseguramos que el contenido no se corte */
        @page {
          size: A4;
          margin: 5mm;
        }
      }
    </style>
  </head>
  <body>
    <div class="page-margins">
      <div class="table-container">
        <table>
          <tr>
            <th rowspan="2" class="texcenter">
              <img
                src="data:image/png;base64,[ImagenLogo]"
                alt="Imagen Logo"
                width="200px"
              />
            </th>
            <th colspan="2" class="texcenter">
              Proceso: Prestación del servicio
            </th>
            <th colspan="2" class="texcenter">Tipo de proceso: Realización</th>
          </tr>
          <tr>
            <th colspan="4" class="texcenter">ORDEN DE SERVICIO DIGITAL</th>
          </tr>
          <tr>
            <th class="texcenter">S.A.S</th>
            <th class="texcenter">Fecha de actualización: 29/01/2024</th>
            <th class="texcenter">Versión: 11</th>
            <th class="texcenter">Codigo: FOR-PS-004</th>
            <th class="texcenter">Nivel de confidencial: Confidencial</th>
          </tr>
        </table>
      </div>

      <div class="table-container">
        <table>
          <tr>
            <th class="texcenter" colspan="4">DATOS DEL CLIENTE</th>
          </tr>
          <tr>
            <th>Orden de servicio N°:</th>
            <td>@{triggerBody()?['ID']}</td>
            <th>Nombre de la empresa:</th>
            <td>@{triggerBody()?['Empresa_x003a_Nombre_Empresa_emp/Value']}</td>
          </tr>
          <tr>
            <th>Fecha de solicitud:</th>
            <td>@{body('Fecha_y_hora_de_creacion')}</td>
            <th>Nombre del usuario:</th>
            <td>@{outputs('nomsolicitante')}</td>
          </tr>
          <tr>
            <th>Fecha de atención:</th>
            <td>@{body('Fecha_y_hora_de_atencion')}</td>
            <th>Correo electrónico:</th>
            <td>@{outputs('correouser')}</td>
          </tr>
          <tr>
            <th>Fecha de llegada:</th>
            <td>@{body('Fecha_y_hora_de_llegada')}</td>
            <th>Dirección:</th>
            <td>@{triggerBody()?['Direcci_x00f3_ndelsolicitante']}</td>
          </tr>
          <tr>
            <th>Fecha de salida:</th>
            <td>@{body('Fecha_y_hora_de_salida')}</td>
            <th>Ciudad:</th>
            <td>@{outputs('ciudadc')}</td>
          </tr>
          <tr>
            <th>Tiempo de solución:</th>
            <td>@{triggerBody()?['Sitio']}</td>
            <th>Nombre del Técnico asignado:</th>
            <td>@{outputs('nomtecnico')}</td>
          </tr>
        </table>
      </div>

      <div class="table-container">
        <table>
          <tr>
            <th class="texcenter">IMPORTANTE</th>
          </tr>
          <tr>
            <th class="descriodocutme">
              <p>
                Este documento tiene como objetivo recopilar y registrar la
                información necesaria, puntual y verídica para dar una correcta
                solución a la petición de servicio. Todo lo que se registre en
                este documento hará parte del servicio y se entenderá como un
                hecho cumplido. Todos los campos son de obligatorio registro. La
                firma por parte del usuario dará a entender para ambas partes
                que la petición del servicio fue solucionada a entera
                satisfacción emitiendo o no una solución definitiva de la falla.
              </p>
            </th>
          </tr>
        </table>

        <table>
          <tr>
            <th class="texcenter" colspan="2">DATOS DEL EQUIPO</th>
          </tr>
          <tr>
            <th>Nombre del equipo:</th>
            <td>@{triggerBody()?['Nombredelequipoatendido']}</td>
          </tr>
          <tr>
            <th>Etiqueta del equipo:</th>
            <td>@{triggerBody()?['Activofijodelequipo']}</td>
          </tr>
          <tr>
            <th>Marca:</th>
            <td>@{triggerBody()?['Marcadelequipo/Value']}</td>
          </tr>
          <tr>
            <th>Modelo:</th>
            <td>@{triggerBody()?['Modelodelequipo']}</td>
          </tr>
          <tr>
            <th>Serial de la Bios:</th>
            <td>@{triggerBody()?['Serialdelequipoatendido']}</td>
          </tr>
          <tr>
            <th>Servicio por garantía:</th>
            <td>@{triggerBody()?['Servicioporgarantia/Value']}</td>
          </tr>
          <tr>
            <th>Servicio con repuesto:</th>
            <td>@{triggerBody()?['Servicioconrepuesto/Value']}</td>
          </tr>
        </table>
      </div>

      <div class="table-container">
        <table>
          <tr>
            <th class="texcenter">DETALLE DEL SERVICIO</th>
          </tr>
          <tr>
            <th>
              (Espacio exclusivo para el técnico) Describa el estado físico y
              visual inicial del equipo:
              <p>@{triggerBody()?['Seguimientouno/Value']}</p>
            </th>
          </tr>
          <tr>
            <th>
              (Espacio exclusivo para el técnico) Solución detallada, amplia y
              concluyente del servicio:
              <p>@{triggerBody()?['Descripci_x00f3_ndelasoluci_x00f']}</p>
            </th>
          </tr>
          <tr>
            <th>
              (Espacio exclusivo para el técnico) Observaciones y
              recomendaciones:
              <p>@{triggerBody()?['Seguimientodos']}</p>
            </th>
          </tr>
          <tr>
            <th>
              (Espacio exclusivo para el usuario) Describa puntualmente la falla
              que presenta el equipo:
              <p>@{triggerBody()?['Description']}</p>
            </th>
          </tr>
        </table>
      </div>

      <div class="table-container">
        <table>
          <th class="advertencia">
            El presente documento constituye el Acta del Servicio prestado. Ha
            sido generado digitalmente y, aunque no contiene firmas manuscritas
            ni firmas electrónicas al momento de su emisión, se reconoce como
            soporte válido para efectos de constancia, trazabilidad y gestión
            interna del servicio, de acuerdo con los registros electrónicos y
            comunicaciones oficiales correspondientes. El documento podrá ser
            suscrito posteriormente mediante firma digital, una vez se habiliten
            los mecanismos requeridos.
          </th>
          <!--<tr>
            <th class="texcenter">Firma del cliente</th>
            <th class="texcenter">Firma del técnico</th>
          </tr>
          <tr>
            <th>Nombre: {nombreuser}</th>
            <th>Nombre: {nombretec}</th>
          </tr>
          <tr>
            <th>Cedula: {cedulaclien}</th>
            <th>Cedula: {cedulatec}</th>
          </tr>
          <tr>
            <th>Firma: {firmacliente}</th>
            <th>Firma: {firmatec}</th>
          </tr>-->
        </table>
      </div>
      <p class="advertencia">
        Tecolsoft S.A.S no se hace responsable por pérdida de datos en el equipo
        revisado. El cliente debe contener backup del mismo. Este servicio tiene
        garantía de 3 días hábiles.
      </p>
    </div>
  </body>
</html>
